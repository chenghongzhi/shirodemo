<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:shiro="http://www.pollix.at/thymeleaf/shiro" th:include="layout/layout">
        <div class="container-fluid" th:fragment="content">
			<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
				<legend>用户修改信息</legend>
			</fieldset>
			<form id="form">
				<input type="hidden" id="id" name="id" th:value="${user.getId()}">
				<div class="form-group">
					<label>用户名</label>
					<input th:readonly="readonly" type="text" id="username" name="username" class="form-control" placeholder="用户名" th:value="${user.getUsername()}">
				</div>
				<div class="form-group">
					<label>密码</label>
					<input type="password" id="password" name="password" class="form-control" placeholder="必填项，请输入密码">
				</div>
				<div class="form-group">
					<label>姓名</label>
					<input th:readonly="readonly" type="text" id="realname" name="realname" class="form-control" placeholder="姓名" th:value="${user.getRealname()}">
				</div>
				<div class="form-group">
					<label>角色:</label>
					<select id="roleId" name="roleId">
						<option th:each="role : ${roles}" th:selected="${user.roleId == role.id}"  th:text="${role.getName()}" th:value="${role.getId()}"></option>
					</select>
				</div>
				<div class="form-group">
					<input type="button" style="width: 50px" id="addBtn" onclick="addUser()" class="btn btn-primary btn-block " value="更新" />
				</div>
			</form>
			<script>
				function addUser() {
					var id = $("#id").val();
					var username = $("#username").val();
					var password = $("#password").val();
					var realname= $("#realname").val();
					var roleId= $("#roleId option:selected").val();
					$.ajax({
						url: '/api/v1/user/updateUsers',
						type: 'post',
						cache: false,
						async: false,
						contentType: 'application/json',
						data: JSON.stringify({
							id: id,
							username: username,
							password: password,
							realname:realname,
							roleId: roleId
						}),
						success: function(data) {
							if (data.meta.success == true) {
								toast("更新成功", "success")
								window.location.href = "/user/list";
								return true;
							} else {
								toast(data.meta.message);
								return false;
							}
						}

					})
				}
			</script>
        </div>
</html>
